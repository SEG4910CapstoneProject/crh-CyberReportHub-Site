<div class="report-articles" [class.dark]="isDarkMode">
  <h1>{{ 'reportNew.header' | translate }}</h1>

  <form *ngIf="form" [formGroup]="form" (ngSubmit)="submit()">

    <div class="form-section">
      <label for="analyst-comment">{{ 'reportNew.analyst' | translate }}:</label>
      <textarea
        id="analyst-comment"
        formControlName="analystComment"
        [attr.maxLength]="maxCommentLength"
        rows="4"
        placeholder="{{ 'reportNew.commentplaceholder' | translate }}"
        class="analyst-comment-textarea"
      ></textarea>
      <div class="char-counter">
        {{ currentCommentLength }}/{{ maxCommentLength }}
      </div>
      <label>Articles:</label>
      <div class="article-list">
        <div
          *ngFor="let article of articles.controls; let i = index"
          [formGroup]="article">
          <input placeholder="Title" formControlName="title" readonly />
          <select formControlName="type">
            <option [value]="article.get('type')?.value">
              {{ article.get('type')?.value }}
            </option>
          </select>
          <select formControlName="category">
            <option value="">-- {{ 'reportNew.category' | translate }} --</option>
            <option value="activeThreats">{{ 'reportNew.activethreats' | translate }}</option>
            <option value="emergingInternationalThreats">
              {{ 'reportNew.emergingthreats' | translate }}
            </option>
            <option value="globalNews">{{ 'reportNew.globalnews' | translate }}</option>
            <option value="customerThreats">{{ 'reportNew.customerthreats' | translate }}</option>
          </select>
          <input placeholder="Link" formControlName="link" readonly />
          <button type="button" (click)="removeArticle(i)">{{ 'common.remove' | translate }}</button>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" (click)="back()">{{ 'common.next' | translate }}</button>
      <button type="submit">{{ 'common.submit' | translate }}</button>
    </div>
  </form>
</div>

<div class="article-selection-box" [class.dark]="isDarkMode">
  <h2>Articles</h2>

  <!-- Add Statistics button -->
  <button type="button" (click)="openAddStatDialog()">{{ 'reportNew.addstats' | translate }}</button>

  <input
    type="text"
    placeholder="{{ 'reportNew.searcharticles' | translate }}..."
    [(ngModel)]="articleSearchTerm"
    (input)="filterArticles()" />
  <div class="article-list-container">
    <crh-progress-spinner *ngIf="isLoading"></crh-progress-spinner>
    <ng-container *ngIf="!isLoading">
    <div
      *ngFor="let article of suggestedArticles"
      (click)="addArticleFromSelection(article)" class="article-item">
      <span>{{ article.title }}</span>
      <button class="add-button">+</button>


</div>
